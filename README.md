# **Coursekey Test Automation Framework**

## **1. Introduction**
The test automation framework was create in order to help technical or non-technical tester to automate their web applications, the main structure is followed by one excel file called DataEngine.xlsx, but if you are a very technical tester, you can use the classes in order to create your own framework or combine with unit testing framework like TestNG or Junit.

When you download the project, you will find, in your DataEngine.xlsx one demo of 3 test cases, you only need to download the object repository and follow the steps in the next chapters the results generated by this framework are:

1. Logs on execution time (console)
2. Log file
3. HTML report
4. Screenshots on error

The knowledge you need to have, if you want to start using this framework, is the web object identification; insomuch as the heart of this framework is Selenium, you need to know how to locate an element, in selenium you will find 8 different ways to do it:

1.	Id 
2.	Name 
3.	Class Name 
4.	Link Text 
5.	Partial Link Text 
6.	Tagname 
7.	Css Selector 
8.	Xpath 

If your object identification is inside these locator types, the framework will be able to identify your object, but don’t worry to tell him which is the right locator to use; the framework will find the locator automatically.

Requirements you need in your computer:
- Admin rights on your computer to download and install apps.
- Chocolatey package manager (only windows and optional)
- Java JDK
- Maven 3.5.0
- Eclipse Luna or above, IntelliJ or another java IDE.
- Supported browsers as of now: Chrome, IE11 or below, Firefox 46 or below.

### **1.2 Design Schema**
![image](https://user-images.githubusercontent.com/24705055/31959791-4d1208cc-b8bb-11e7-94b5-a9e259786cd1.png)


### **1.3 Action Keywords Reference**

| ﻿Action Keyword              | Description                                                                                                                                                                                                               | Page Object | Data (example)                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------------|
| acceptAlert                 | Click on Ok alert button                                                                                                                                                                                                  | No          | No                                                                           |
| authenticateAlert           | Set user and password over one Js alert                                                                                                                                                                                   | No          | user,password                                                                |
| callAutoit                  | Execute Autoit exe                                                                                                                                                                                                        | No          | C:/path/autoitfile.exe                                                       |
| clear                       | Clear a text box                                                                                                                                                                                                          | Yes         | No                                                                           |
| click                       | Click over an element                                                                                                                                                                                                     | Yes         | No                                                                           |
| clickAndHold                | Click an hold on some place of the page or over an element                                                                                                                                                                | Yes/No      | No                                                                           |
| clickOnAllLinks             | Demo of one custom action                                                                                                                                                                                                 | Yes         | No                                                                           |
| clickOnItemByIndex          | Clicking on web element using his index, you can use, finding the las item: .//*[@id='gbw']/div/div/div[1]/div[1] Or you can find an element indicating the exact element you need: .//*[@id='gbw']/div/div/div[1]/div[1] | Yes         | Using Index and complement: 1, /div [1]                                      |
| clickOnTextItem             | Click on element using his inner text                                                                                                                                                                                     | No          | Login (text in button)                                                       |
| deselectAllFromList         | Deselect multiple or all items from one List                                                                                                                                                                              | Yes         | No                                                                           |
| deselectByIndexFromList     | Deselect an element using his index                                                                                                                                                                                       | Yes         | Index: 4                                                                     |
| deselectByTextFromList      | Deselect an element using his inner text                                                                                                                                                                                  | Yes         | Canada (exact text displayed)                                                |
| deselectByValueFromList     | Deselect an element using his html value property                                                                                                                                                                         | Yes         | Value from html                                                              |
| dismissAlert                | Click on JS alert Cancel button                                                                                                                                                                                           | No          | No                                                                           |
| doubleClick                 | Perform a double click on the page or over an element                                                                                                                                                                     | Yes/No      | No                                                                           |
| elementIsDisplayed          | Verify if the element is displayed in the page                                                                                                                                                                            | Yes         | No                                                                           |
| elementIsEnabled            | Verify if the element is enable in the page                                                                                                                                                                               | Yes         | No                                                                           |
| elementIsSelected           | Verify if the element is selected in the page                                                                                                                                                                             | Yes         | No                                                                           |
| executeJavaScript           | Execute JavaScript code                                                                            | Yes/No      | You can execute javascript code, also you can execute JS codeover an element |
|                             |                                                                                                       
| findTableRow                | Search for one specific row, is recommended use xpath                                                                                                                                                                     | Yes         | Index of element: 9                                                          |
| getElementAttribute         | Get the attribute of one element                                                                                                                                                                                          | Yes         | Yes                                                                          |
| getElementClass             | Get the Class of one element                                                                                                                                                                                              | Yes         | Yes: class to compareNo: empty                                               |
| getElementCSS               | Get the CSS value of one element                                                                                                                                                                                          | Yes         | Css value to get                                                             |
| getElementLocation          | Get the Location of one element                                                                                                                                                                                           | Yes         | Yes: location to compare > x, yNo: empty                                     |
| getElementSize              | Get the Size of one element                                                                                                                                                                                               | Yes         | Yes: location to compare > high, weightNo: empty                             |
| getElementTagname           | Get the Tagname of one element                                                                                                                                                                                            | Yes         | Yes: tagname to compare > divNo: empty                                       |
| getElementText              | Get the inner text of one element                                                                                                                                                                                         | Yes         | Yes: text to compare > user gmaresNo: empty                                  |
| getPageClass                | Get web page class                                                                                                                                                                                                        | No          | Yes: class to compareNo: empty                                               |
| getPageCurrentUrl           | Get web page current URL                                                                                                                                                                                                  | No          | Yes: Url to compareNo: empty                                                 |
| getPageSource               | Get web page HTML source code                                                                                                                                                                                             | No          | Yes: source code to compareNo: empty                                         |
| getPageTitle                | Get web page Title                                                                                                                                                                                                        | No          | Yes: Title to compareNo: empty                                               |
| getStringAllObjects         | Example of custom action                                                                                                                                                                                                  | Yes         | Yes: String1,string2,string3, …No: empty                                     |
| getTextBoxText              | Getting the text typed in text box                                                                                                                                                                                        | Yes         | Yes: Text to compareNo: empty                                                |
| getTextFromAlert            | Get the text from JS alert                                                                                                                                                                                                | No          | Yes: Text to compareNo: empty                                                |
| getWindowHandle             | Get web page class                                                                                                                                                                                                        | No          | Title of web page                                                            |
| getWindowHandles            | Get web page class                                                                                                                                                                                                        | No          | Title of web page                                                            |
| goPageBack                  | Go to previous web page                                                                                                                                                                                                   | No          | No                                                                           |
| goPageForward               | Go forward over the web pages                                                                                                                                                                                             | No          | No                                                                           |
| input                       | Type text                                                                                                                                                                                                                 | Yes         | Text to type                                                                 |
| inputActions                | Second for of type text                                                                                                                                                                                                   | Yes/No      | Text to type                                                                 |
| keyDown                     | Press a key                                                                                                                                                                                                               | Yes/No      | Key value                                                                    |
| keyUp                       | Release a key                                                                                                                                                                                                             | Yes/No      | Key value                                                                    |
| lastTableItem               | Search for the all the table rows and highlight over the last row (item)                                                                                                                                                  | Yes         | Row xpath: .//*[@id='gbw']/div/div/div[1]/                                   |
| loginWindowsCredentials     | Login using active directory                                                                                                                                                                                              | No          | username,password                                                            |
| moveToElement               | Move in the middle of one web element                                                                                                                                                                                     | Yes         | No                                                                           |
| navigate                    | Go to one URL                                                                                                                                                                                                             | No          | URL                                                                          |
| refreshPage                 | Refresh the actual web page                                                                                                                                                                                               | No          | No                                                                           |
| release                     | Release a click over the page or one element                                                                                                                                                                              | Yes/No      | No                                                                           |
| rightClick                  | Perform right click over the page or one element                                                                                                                                                                          | Yes/No      | No                                                                           |
| robot                       | Manipulate system windows                                                                                                                                                                                                 | No          | See the second table                                                         |
| scrollWindow                | Scroll web page                                                                                                                                                                                                           | No          | Scroll up: 0,-250Scroll down: 0,250                                          |
| searchItemByIndex           | Search web element using his index, you can use, finding the las item: .//*[@id='gbw']/div/div/div[1]/div[1] Or you can find an element indicating the exact element you need: .//*[@id='gbw']/div/div/div[1]/div[1]      | Yes         | Using only Index: 1Using Index and complement: 1, div [1]                    |
| searchObjectByText          | Search one element using the inner text                                                                                                                                                                                   | Yes         | Text to search                                                               |
| selectByIndexFromList       | Select an element using his index                                                                                                                                                                                         | Yes         | Index: 4                                                                     |
| selectByTextFromList        | Select an element using his inner text                                                                                                                                                                                    | Yes         | Canada (exact text displayed)                                                |
| selectByValueFromList       | Select an element using his html value property                                                                                                                                                                           | Yes         | Value from html                                                              |
| setTextToAlert              | Type on JS alert                                                                                                                                                                                                          | No          | Text to set                                                                  |
| snapShot                    | Take step snapshot                                                                                                                                                                                                        | Yes/No      | Image name                                                                   |
| submitForm                  | Submit a form                                                                                                                                                                                                             | Yes         | No                                                                           |
| switchToFrame               | Switch to one frame                                                                                                                                                                                                       | Yes         | No                                                                           |
| switchToWindow              | Switch to other window                                                                                                                                                                                                    | No          | Window name                                                                  |
| wairForAlert                | Wait 20 seconds for an JS alert                                                                                                                                                                                           | No          | No                                                                           |
| waitFor                     | Stops execution for some time                                                                                                                                                                                             | No          | Duration time as integer: 6                                                  |
| waitForAllElementsVisible   | Wait 20 seconds for all web elements visible, for example, all check boxes, all links, etc.                                                                                                                               | Yes         | No                                                                           |
| waitForElementClickable     | Wait 20 seconds for an element clickable                                                                                                                                                                                  | Yes         | No                                                                           |
| waitForElementToBeSelected  | Wait 20 seconds for an element to be selected                                                                                                                                                                             | Yes         | No                                                                           |
| waitForElementVisible       | Wait 20 seconds for an element visible                                                                                                                                                                                    | Yes         | No                                                                           |
| waitForFrameAndSwitchToIt   | Wait 20 seconds for a frame and then switch to it, Please don’t use switch to frame an then this action, this action switchautomatically when the frame is located                                                        | Yes         | No                                                                           |
| waitForPresenceOfAllElement | Wait 20 seconds for presence of all elements, for example, all check boxes, all links, etc.                                                                                                                               | Yes         | No                                                                           |
| waitForPresenceOfElement    | Wait 20 seconds for presence of an element                                                                                                                                                                                | Yes         | No                                                                           |
| waitForTextPresent          | Wait 20 seconds for text presented on web page                                                                                                                                                                            | Yes         | Text to be present                                                           |
| waitForTitleContains        | Wait 20 seconds for the title contains certain words                                                                                                                                                                      | Yes         | String for title                                                             |
| waitForUrlMatch             | Wait 20 seconds for an exact URL                                                                                                                                                                                          | Yes         | Exact URL                                                                    |
| waitInvisibilityOfElement   | Wait 20 seconds for invisibility of an element                                                                                                                                                                            | Yes         | No                                                                           |

Table with all robot functionality and how to type into your steps sheet:

*General*
|            |              |              |               |             |         |            |
|------------|--------------|--------------|---------------|-------------|---------|------------|
| ﻿up (arrow) | down (arrow) | left (arrow) | right (arrow) | esc         | control | shift      |
| alt        | tab          | enter        | space         | printscreen | windows | rightclick |

*Common Combination*
|      |     |       |           |      |      |     |       |       |
|------|-----|-------|-----------|------|------|-----|-------|-------|
| ﻿copy | cut | paste | selectall | save | open | new | close | print |

*Numbers*
|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
| ﻿0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |

*Special characters*
|                 |   |   |   |   |   |   |     |
|-----------------|---|---|---|---|---|---|-----|
| ﻿@               | ! | # | $ | % | ^ | ( | )   |
| \\ (back slash) | { | } | [ | ] | , | . | < > |
| -               | + | ; | : | _ | ? | & | *   |

*Functions*
|    |    |    |     |     |     |
|----|----|----|-----|-----|-----|
| ﻿f1 | f2 | f3 | f4  | f5  | f6  |
| f7 | f8 | f9 | f10 | f11 | f12 |

## **2. Project Setup**

1. On Bitbucket, navigate to the main page of the repository: https://bitbucket.org/coursekey/automationframework.
2. Copy the URL for the repository: https://username@bitbucket.org/coursekey/automationframework.git
3. Open Git Bash.
4. Change the current working directory to the location where you want the cloned directory to be made.
5. Type *git clone*, and then paste the URL you copied in Step 2.
    `git clone https://username@bitbucket.org/coursekey/automationframework.git`
6. Press Enter. Your local clone will be created.
7. Your project must appear like the image below.

![image](https://user-images.githubusercontent.com/24705055/31961399-3725ff8c-b8c0-11e7-86ab-e369abb01fd3.png)


8. In your C:// directory, you need to download all the necessary files from: https://drive.google.com/a/thecoursekey.com/file/d/0Bz18GGTy0N08eGg4bnJCQmtQb28/view?usp=sharing and placed there 

## **3. Sub Folder Sructure**

### **3.1 Source Folder (src)**

This folder contains four different packages, config, executionEngine, objects and utility, inside this packages are all the classes needed to execute the data engine. All the classes and their functionalities are explained below.

| ﻿Package         | Class           | Description                                                       							 |  
|-----------------|-----------------|------------------------------------------------------------------------------------------------|
| config          | ActionKeywords  | Contains all actions like input, click, clear, navigate, each action is represented as method" |
|                 | Constants       | Constants needed for the framework are in this class             								 |
|                 | ReadObject      | Used to read property files                                       							 |
|                 | Reporter        | Generate HTML reports                                             							 |
| executionEngine | DriverScript    | The logic to execute the DataEngine.xlsx is in DriverScript class 							 |
| properties      | General         | General properties as browserDriver and screenShot are here"      							 |
|                 | Results         | Properties used in Reporter class                                 							 |
|                 | Test            | Super class used by TestCase and  TestStep classes                							 |
|                 | TestCase        | Properties used for each test case                                							 |
|                 | TestStep        | Properties used for each step like data ActionKeyword, object, etc. 							 | 
| utility         | DriverException | Custom exception used to generate logs, screenshots, etc.										 |
|                 | ExcelUtils      | Methods used to manipulate the DataEngine.xlsx                    							 |
|                 | Log             | All logs levels are in this class                                 							 |
|                 | SeleniumRobot   | Class used to handled operative system windows, etc.                                           | 
|                 | SeleniumUtils   | Screenshot, email and highlight methods are in this class		                                 |

### **3.2 Resources Folder**

Files used to run our framework are stored in this folder.

| ﻿File                           | Description                                   |
|--------------------------------|-----------------------------------------------|
| log4j.xml                      | File to generate and format the logs.log file |
| TestCase_report_template.html  | Template for test cases html report           |
| TestSteps_report_template.html | Template for test steps html report           |

## **4. Setting the Execution**
### **4.1 Config File**

1. Open config.properties file previously downloaded.
2. The first variable you will find is Browser, you need to set your browser as Chrome, Firefox, Safari or IE for internet explorer.
3. In the second area of variables you need to specify where are your drivers stored.
4. The third part consist on indicate the name of your data engine file; you can create multiple engine files or only one.
5. In Object Repository property, you need to indicate the complete path and name (with extension) of your repository file (if you want to include one).
6. you can indicate to open the html report, logs and data engine files automatically after the execution is completed if you don’t want to open one or more files when the execution is completed, you need to set the value as false.
7. The last part is the email info, if you want to send email on error; you need to set the variable SendEmail as true, Host variable need to indicate the mail protocol you will use. SmtpPort is the port where you are able to send the email, in From and Password variables you need to indicate your email credentials and the last variable is To, you need to add the email direction you want to send the email.

![image](https://user-images.githubusercontent.com/24705055/31959958-dd39dd3a-b8bb-11e7-9a2f-715b4f2700af.png)

### **4.2 Test Case Sheet**

1. Open DataEngine file previuosly downloaded.
2. Go to Test Cases tab and fill column Test Case ID (mandatory field) with the name of your test case.
3. Fill with a brief description on Description column.
4. Run column will define if the specified test case will be executed or no (Yes or No flag)
5. DDT Sheet column will let you define if the test it’s going to be Data Driven, you need to add the sheet name for that specific test case, note: you can create all data sheets you want in this file.
6. Result column will fill after the test is done with the result.

![image](https://user-images.githubusercontent.com/24705055/31960112-5153debe-b8bc-11e7-8b64-c004dc309aae.png)

### **4.3 Object Repository**

1. open ObjRep.txt file.
2. Open your browser (Chrome is recommended) and load the page you will work with.
3. You can inspect the object and extract his property (id, name, xpath, etc).

![image](https://user-images.githubusercontent.com/24705055/31960162-795578be-b8bc-11e7-8c36-844e3f4e9ea8.png)

4. Copy the value displayed in XPath box or if you are in HTML
5. Paste the property you have selected on your object repository file with a *unique alias* and continue gathering your objects to have your repository ready. Save your file once you’re done.

![image](https://user-images.githubusercontent.com/24705055/31960189-94ae7944-b8bc-11e7-9179-7446dc778a1b.png)

6. Go back to DataEngine file and let’s define the Page Object Model into our file
7. Define the pages name in *Page Name* column.

![image](https://user-images.githubusercontent.com/24705055/31960214-accdce44-b8bc-11e7-8126-3035edf6dd8b.png)

8. Add a column with the name of each of the pages you will utilize.

![image](https://user-images.githubusercontent.com/24705055/31960267-db6f25fe-b8bc-11e7-9ea3-0a6bafab272e.png)

9. Set the objects by page on their respective column.

![image](https://user-images.githubusercontent.com/24705055/31960295-eeaccd1a-b8bc-11e7-845c-2168b6823ded.png)

*Remember, the object placed into your pages, need to be the same you have in your object repository.*

![image](https://user-images.githubusercontent.com/24705055/31960325-0900dbc0-b8bd-11e7-8a2b-d9521c3dae14.png)

10. Map the objects to the page by selecting al the cells containing objects for a specific page, then click on the cell text box and enter the name of the page. Press enter after.
11. Set the page name on the field. Repeat last step.

![image](https://user-images.githubusercontent.com/24705055/31960349-205ec232-b8bd-11e7-8274-54275b75f030.png)

12. Validate your mapping in Test Steps tab, go to column Page and click on the drop down menu on any of the cells to validate the pages are loaded in the menu. Once selected, validate the objects are loaded in Page Object column.

![image](https://user-images.githubusercontent.com/24705055/31960438-6a0022d2-b8bd-11e7-9100-496827d4ac28.png)

### **4.4 Test Steps Sheet**

1. Fill column Test Case ID with the name of your test case and repeat it as many times as steps you’ll execute.
2. Fill TS_ID according to the steps by test case.
3. Add a description of each of the steps.
4. Select page from Page Name drop down menu accordingly.
5. Select objects from Page Object drop down menu.
6. Select the desired action from Action Keyword drop down menu.
7. Fill the data set if you need.

![image](https://user-images.githubusercontent.com/24705055/31960491-911e9dc6-b8bd-11e7-9df1-5a1b4f8039b4.png)

8. Save your excel sheet and close the file.
If you don’t want to use the Page Object Model into data engine file, you can hide the column Page Name and paste the objects locators directly into your *Page Object* column.

![image](https://user-images.githubusercontent.com/24705055/31960507-9f8f774a-b8bd-11e7-9b4e-ddeb198ed4f2.png)

### **4.5 Test Data Sheet**

1. If you will use data driven framework, you can create your data sheet and name as you want.

![image](https://user-images.githubusercontent.com/24705055/31960545-c1e6e724-b8bd-11e7-80b0-97fe6d0c5bf5.png)

2. You can add all the parameters you want and call them as you wish.

![image](https://user-images.githubusercontent.com/24705055/31960572-d4a3d354-b8bd-11e7-8eb8-d70203787efe.png)

3. The important part is, you need to call your parameter in your test step sheet.

![image](https://user-images.githubusercontent.com/24705055/31960601-eaa32b5a-b8bd-11e7-83f4-8586e9ca341d.png)

4. The framework will take the values of each parameter and will iterate over all the rows with test data.

## **5. Execution and Results**

### **5.1 Running using console**

1. Go to your project root folder (your pom file must be visible).
2. Open a console (admin rights recommended)
3. Execute the commandos one after the other:
    - `mvn clean` 
    - `mvn validate` 
    - `mvn compile`
    - `mvn test`
4. Wait for your test to finish.
5. Go to your ConfigurationFile folder and open Results folder

### **5.2 Console Log**

When your script is running, logs are displayed in the console panel, if le log is an error, the information will be displayed in red.

![image](https://user-images.githubusercontent.com/24705055/31960665-14782782-b8be-11e7-8d82-9b63155d186a.png)

### **5.3 Log File**

1. Open logfile file
2. Check your execution (either pass or fail)

![image](https://user-images.githubusercontent.com/24705055/31960708-371912d8-b8be-11e7-8854-a2260971c3fd.png)

### **5.4 Excel File**

1. Open your DataEngine file
2. Go to Test Case tab
3. Go to Test Steps tab
4. If you added test data sheet, go to verify your results

*Test Case Tab*

![image](https://user-images.githubusercontent.com/24705055/31960746-536d889c-b8be-11e7-8300-ede211c23a82.png)

*Test Steps Tab*

![image](https://user-images.githubusercontent.com/24705055/31961152-81016c46-b8bf-11e7-8745-0c2b75d3f2aa.png)

*Test Data Tab*

![image](https://user-images.githubusercontent.com/24705055/31961168-93c658c8-b8bf-11e7-93c8-2b66a79f6418.png)

### **5.5 HTML Report**

In order to display the results in your java IDE, you need to refresh your project and automatically your results will be displayed.

![image](https://user-images.githubusercontent.com/24705055/31961279-e8e32b2e-b8bf-11e7-9b5a-d9dddee9da1c.png)

1. Once in results folder a file with the results will be generated after the run.
2. Open TestCaseReport file generated.

![image](https://user-images.githubusercontent.com/24705055/31961322-00b538f0-b8c0-11e7-9316-47f48d426202.png)

3. Click on PASS link (or FAIL depending on the result of the execution) to validate the steps.

![image](https://user-images.githubusercontent.com/24705055/31961338-130914f4-b8c0-11e7-9a4f-9c9c023de968.png)

### **5.6 Email on Error**

If one step fails you will receive an email indicating the exception caught.

![image](https://user-images.githubusercontent.com/24705055/31961371-24adc006-b8c0-11e7-8a2e-61be0f829316.png)

## **6. Test Automation Guidelines**

If code is modified inside the framework's classes you need to follow the steps below:

1. When a method or class is modified the tester need to add a comment with: *modification date* and *tester's name*, use the next example: 
    `// Modified 27/09/2017, 'What was modified?' Gilberto Sánchez Mares`
2. Pull the code from Bitbucket in order to have the latest code version.
3. Delete files (logs, html) and folders (screenshot) from result folder.
4. Before push a change, code review must be performed by Gilberto Sánchez.
5. When code review pass, the tester must inform about the push in #automationFramework slack group.
6. When all the team is informed about the new push, follow the next commands:
    -`git push origin master`
7. Inform all the team, the push was succesfully done.